<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard | The Habit Loop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" href="logo.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-47YP5C93M8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-47YP5C93M8');
</script>
  <style>
    :root {
      --bg-dark: #0D1117;
      --bg-secondary: #161B22;
      --primary-blue: #3B82F6;
      --text-light: #E6EDF3;
      --text-muted: #8D96A0;
      --border-color: #30363D;
      --pause-yellow: #f59e0b;
      --resume-green: #10b981;
      --danger-red: #ef4444;
      --fire-orange: #f97316;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background-color: var(--bg-dark); color: var(--text-light); }
    .navbar { display: flex; justify-content: space-between; align-items: center; padding: 0 2rem; height: 70px; background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 1000; }
    .logo { font-size: 1.5rem; font-weight: 700; text-decoration: none; color: var(--text-light); display: flex; align-items: center; gap: 8px; }
    .logo .fa-fire { color: var(--primary-blue); }
    .nav-actions { display: flex; align-items: center; gap: 1.5rem; }
    .streak-counter { display: flex; align-items: center; gap: 0.5rem; font-size: 1.1rem; font-weight: 600; background-color: var(--bg-dark); padding: 8px 16px; border-radius: 8px; border: 1px solid var(--border-color); }
    .streak-counter .fa-fire { color: var(--fire-orange); animation: flame 1.5s infinite; }
    @keyframes flame { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    .profile-menu-container { position: relative; }
    .profile-avatar { width: 40px; height: 40px; border-radius: 50%; background-color: var(--primary-blue); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; user-select: none; }
    .profile-avatar:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(59, 130, 246, 0.4); }
    .profile-dropdown { position: absolute; top: 120%; right: 0; background-color: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); min-width: 240px; padding: 0.5rem 0; z-index: 1001; opacity: 0; visibility: hidden; transform: translateY(10px); transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s; }
    .profile-dropdown.show { opacity: 1; visibility: visible; transform: translateY(0); }
    .dropdown-header { padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-color); margin-bottom: 0.5rem; }
    .dropdown-header .user-name { font-weight: 600; }
    .dropdown-item { display: block; padding: 0.75rem 1rem; color: var(--text-muted); text-decoration: none; transition: background-color 0.2s ease, color 0.2s ease; }
    .dropdown-item i { margin-right: 10px; width: 20px; text-align: center; }
    .dropdown-item:hover { background-color: var(--bg-dark); color: var(--text-light); }
    .dropdown-item.logout:hover { background-color: rgba(239, 68, 68, 0.1); color: var(--danger-red); }
    .container { max-width: 1100px; margin: 0 auto; padding: 2.5rem 20px; }
    .welcome-header { font-size: 2.5rem; font-weight: 700; margin-bottom: 2.5rem; } .dashboard-grid { display: grid; grid-template-columns: 300px 1fr; gap: 2rem; }
    .right-column-grid { display: flex; flex-direction: column; gap: 2rem; }
    .card { background-color: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; }
    .card-header { display: flex; align-items: center; gap: 0.75rem; font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
    .card-actions { margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 0.75rem; }
    .btn-action { width: 100%; padding: 10px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: opacity 0.3s ease; }
    .btn-action:hover { opacity: 0.85; }
    .btn-action:disabled { cursor: not-allowed; opacity: 0.5; }
    .btn-edit { background-color: var(--primary-blue); color: white; }
    .btn-pause { background-color: var(--pause-yellow); color: white; }
    .btn-resume { background-color: var(--resume-green); color: white; }
    .settings-list dt { font-weight: 500; color: var(--text-muted); font-size: 0.9rem; margin-top: 1rem; }
    .settings-list dd { font-weight: 600; font-size: 1rem; }
    .status-card-body { display: flex; flex-direction: column; gap: 1.25rem; }
    .streak-highlight { text-align: center; font-size: 2.5rem; font-weight: 800; }
    .streak-highlight .fa-fire { color: var(--fire-orange); }
    .progress-bar-container { width: 100%; background-color: var(--bg-dark); border-radius: 5px; height: 10px; overflow: hidden; }
    .progress-bar-fill { height: 100%; width: 0%; background-color: var(--primary-blue); border-radius: 5px; transition: width 0.5s ease-in-out; }
    .progress-text { text-align: center; font-size: 0.8rem; font-weight: 500; color: var(--text-muted); margin-top: 0.5rem; }
    .status-details { display: flex; flex-direction: column; gap: 0.5rem; }
    .status-item { display: flex; align-items: center; gap: 0.75rem; }
    .status-indicator { width: 10px; height: 10px; border-radius: 50%; }
    .status-indicator.active { background-color: var(--resume-green); }
    .status-indicator.paused { background-color: var(--pause-yellow); }
    .log-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 1rem; }
    .log-card { background-color: var(--bg-dark); border: 1px solid var(--border-color); border-radius: 12px; padding: 1rem; text-align: center; text-decoration: none; color: var(--text-light); transition: transform 0.3s ease, border-color 0.3s ease; }
    .log-card:hover { transform: translateY(-5px); border-color: var(--primary-blue); }
    .log-card .day-number { font-size: 2.5rem; font-weight: 700; color: var(--primary-blue); }
    .log-card .day-title { font-weight: 600; margin-top: 0.25rem; }
    .log-card .day-level { font-size: 0.8rem; color: var(--text-muted); }
    #logList p { grid-column: 1 / -1; text-align: center; color: var(--text-muted); padding: 2rem; }
    #curriculum-section { margin-top: 2rem; }
    .course-level { margin-bottom: 2.5rem; }
    .course-level:last-child { margin-bottom: 0; }
    .course-level h4 { font-size: 1.5rem; font-weight: 600; color: var(--text-light); margin-bottom: 1.2rem; display: flex; align-items: center; flex-wrap: wrap; gap: 10px; }
    .course-level h4 .level-title { font-weight: 500; color: var(--text-muted); font-size: 1.1rem; }
    .course-level h4 i { color: var(--primary-blue); }
    .days { display: flex; flex-wrap: wrap; gap: 0.75rem; }
    .day-card { background-color: var(--bg-dark); border: 1px solid var(--border-color); padding: 0.75rem 1rem; border-radius: 8px; cursor: pointer; text-align: center; font-weight: 500; flex-basis: 90px; transition: all 0.2s ease-in-out; }
    .day-card:hover { transform: translateY(-4px); border-color: var(--primary-blue); }
    .day-card.active { background-color: var(--primary-blue); border-color: var(--primary-blue); color: white; transform: translateY(-2px); }
    .day-card.completed { background-color: rgba(16, 185, 129, 0.1); border-color: var(--resume-green); color: var(--resume-green); font-weight: 700; }
    .day-card.completed:hover { color: white; background-color: var(--resume-green); }
    .day-card.completed.active { color: white; background-color: var(--primary-blue); border-color: var(--primary-blue); }
    .topic-slide-panel { background-color: var(--bg-dark); border: 1px solid var(--border-color); border-top: 3px solid var(--primary-blue); margin-top: 1rem; padding: 1.5rem; border-radius: 8px; overflow: hidden; max-height: 0; opacity: 0; visibility: hidden; transition: all 0.5s ease-in-out; }
    .topic-slide-panel.show { max-height: 200px; opacity: 1; visibility: visible; }
    .topic-slide-panel strong { color: var(--primary-blue); }
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 2000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s; }
    .modal-overlay.show { opacity: 1; visibility: visible; }
    .modal-content { background-color: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem; width: 100%; max-width: 400px; transform: scale(0.95); transition: transform 0.3s ease; }
    .modal-overlay.show .modal-content { transform: scale(1); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
    .modal-header h2 { font-size: 1.5rem; margin: 0; }
    .close-btn { background: none; border: none; font-size: 1.5rem; color: var(--text-muted); cursor: pointer; transition: color 0.2s; }
    .close-btn:hover { color: var(--text-light); }
    .modal-body .input-group { margin-bottom: 1rem; }
    .modal-body .input-group label { font-size: 0.9rem; }
    .modal-body input { font-size: 1rem; }
    .modal-footer { margin-top: 1.5rem; }
    .btn-save { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; background-color: var(--primary-blue); color: white; transition: background-color 0.2s; }
    .btn-save:hover { background-color: var(--primary-blue-hover); }
    @media (max-width: 768px) { .dashboard-grid { grid-template-columns: 1fr; } .navbar { padding: 0 1rem; } .logo { font-size: 1.2rem; } .streak-counter { font-size: 1rem; padding: 6px 12px;} }
        /* --- ✅✅✅ NEW ACHIEVEMENT STYLES ✅✅✅ --- */
    .achievements-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 1.5rem;
    }
    .badge {
        text-align: center;
    }
    .badge-icon {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background-color: var(--bg-dark);
        border: 3px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 0.75rem auto;
        font-size: 2rem;
        color: var(--border-color); /* Color for locked badges */
        transition: all 0.3s ease;
        position: relative;
    }
    .badge-icon.unlocked {
        color: var(--pause-yellow); /* Gold color for unlocked badges */
        border-color: var(--pause-yellow);
        box-shadow: 0 0 20px rgba(245, 158, 11, 0.4);
    }
    .badge-title {
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--text-muted);
        transition: color 0.3s ease;
    }
    .badge-icon.unlocked + .badge-title {
        color: var(--text-light); /* Bolder title for unlocked badges */
    }
    /* Simple tooltip for description */
    .badge-icon[data-tooltip]::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 110%;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--bg-dark);
        color: var(--text-light);
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.9rem;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.2s, visibility 0.2s;
        z-index: 10;
    }
    .badge-icon:hover::after {
        opacity: 1;
        visibility: visible;
    }  
     .dashboard-grid {
        display: grid;
        grid-template-columns: 280px 1fr 300px;
        gap: 2rem;
    }
    .left-column, .center-column, .right-column {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }
    


    /* ... a good place is after your .achievements-grid styles ... */

/* --- ✅✅✅ NEW TIPS & RESOURCES STYLES ✅✅✅ --- */
.card-header .refresh-tip-btn {
    margin-left: auto; /* Pushes the button to the far right */
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 1rem;
    padding: 5px;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color 0.2s, background-color 0.2s;
}
.card-header .refresh-tip-btn:hover {
    color: var(--text-light);
    background-color: var(--bg-dark);
}
.resource-hub-body {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}
#resource-hub-content h5 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: var(--text-light);
}
#resource-hub-content ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.resource-link {
    display: block;
    text-decoration: none;
    color: var(--text-muted);
    font-weight: 500;
    padding: 8px 12px;
    border-radius: 6px;
    background-color: var(--bg-dark);
    border: 1px solid var(--border-color);
    transition: all 0.2s ease;
}
.resource-link:hover {
    color: var(--primary-blue);
    border-color: var(--primary-blue);
    transform: translateX(4px);
}
.resource-link i {
    margin-right: 8px;
}
.tip-of-the-day {
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-color);
}
.tip-title {
    font-weight: 600;
    color: var(--text-muted);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}
.tip-text {
    font-style: italic;
    color: var(--text-light);
    font-size: 0.95rem;
    line-height: 1.6;
}
/* --- ✅✅✅ END OF NEW STYLES ✅✅✅ --- */

    /* --- (All other card, button, and modal styles are unchanged) --- */

    /* ✅✅✅ NEW RESPONSIVE STYLES ✅✅✅ */
    @media (max-width: 1200px) {
        .dashboard-grid {
            grid-template-columns: 280px 1fr;
        }
        .right-column {
            grid-column: 2 / 3;
        }
    }
    @media (max-width: 992px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
        .right-column {
            grid-column: 1 / 2;
        }
    }
    @media (max-width: 768px) {
        .navbar { padding: 0 1rem; }
        .logo { font-size: 1.2rem; }
        .streak-counter { font-size: 1rem; padding: 6px 12px;}
    }
  </style>
</head>
<body>

  <nav class="navbar">
    <a href="index.html" class="logo"><i class="fa-solid fa-fire"></i>The Habit Loop</a>
    <div class="nav-actions">
      <div class="streak-counter">
        <i class="fa-solid fa-fire"></i>
        <span>Streak: <span id="nav-streak">...</span></span>
      </div>
      <div class="profile-menu-container">
          <div class="profile-avatar" id="profile-avatar">S</div>
          <div class="profile-dropdown" id="profile-dropdown">
              <div class="dropdown-header"><div class="user-name" id="dropdown-username">...</div></div>
              <a href="index.html" class="dropdown-item"><i class="fa-solid fa-house"></i> Home</a>
              <a href="dashboard.html" class="dropdown-item"><i class="fa-solid fa-table-columns"></i> Dashboard</a>
              <a href="instructions.html" class="dropdown-item"><i class="fa-solid fa-circle-question"></i> How to Use</a>
              <a href="#" class="dropdown-item" id="editTimeBtn"><i class="fa-solid fa-clock"></i> Edit Time</a>
              <a href="#" class="dropdown-item" id="editNumberBtn"><i class="fa-brands fa-whatsapp"></i> Edit Number</a>
              <a href="#" class="dropdown-item logout" id="deleteAccountBtn"><i class="fa-solid fa-user-slash"></i> Delete Account</a>
              <a href="#" class="dropdown-item logout" id="logoutBtn"><i class="fa-solid fa-arrow-right-from-bracket"></i> Logout</a>
          </div>
      </div>
    </div>
  </nav>

    <main class="container">
    <h1 class="welcome-header">🫡 Welcome, <span id="welcomeName">...</span>!</h1>
    
    <!-- ✅✅✅ NEW 3-COLUMN GRID STRUCTURE ✅✅✅ -->
    <div class="dashboard-grid">
      
      <!-- COLUMN 1: SETUP & CONTROLS -->
      <aside class="left-column">
        <div class="card">
          <div class="card-header"><i class="fa-solid fa-gears"></i><span>Your Coding Setup</span></div>
          <dl class="settings-list">
            <dt>Language</dt><dd id="lang"></dd>
            <dt>Level</dt><dd id="level"></dd>
            <dt>WhatsApp</dt><dd id="wa"></dd>
            <dt>Daily Time</dt><dd id="time"></dd>
          </dl>
          <div class="card-actions">
            <button class="btn-action btn-edit" id="editBtn">Edit Schedule (Reset)</button>
            <button class="btn-action" id="pauseBtn">Pause Course</button>
          </div>
        </div>
         <section class="card">
        <div class="card-header">
            <i class="fa-solid fa-lightbulb"></i>
            <span>Tips & Resources</span>
            <button class="refresh-tip-btn" id="refresh-tip-btn" title="Get a new tip">
                <i class="fa-solid fa-arrows-rotate"></i>
            </button>
        </div>
        <div class="resource-hub-body">
            <div id="resource-hub-content">
                <!-- Resource links will be injected here by JS -->
            </div>
            <div class="tip-of-the-day">
                <p class="tip-title">💡 Quick Tip:</p>
                <p class="tip-text" id="quick-tip-text">Loading tip...</p>
            </div>
        </div>
    </section>
      </aside>

      <!-- COLUMN 2: MAIN CONTENT -->
      <div class="center-column">
        <section class="card">
          <div class="card-header"><i class="fa-solid fa-list-check"></i><span>Progress Log</span></div>
          <div class="log-grid" id="logList"><p>Loading your progress...</p></div>
        </section>
        
        <section id="curriculum-section" class="card">
            <div class="card-header"><i class="fa-solid fa-book-open"></i><span>Course Curriculum</span></div>
            <div id="curriculum-container"><p>Loading your curriculum...</p></div>
        </section>
      </div>
      
      <!-- COLUMN 3: STATUS & REWARDS -->
      <aside class="right-column">
        <section class="card">
            <div class="card-header"><i class="fa-solid fa-chart-line"></i><span>Streak Status</span></div>
            <div class="status-card-body">
                <div class="streak-highlight"><i class="fa-solid fa-fire"></i> <span id="streak-card">...</span> Days</div>
                <div>
                    <div class="progress-bar-container"><div class="progress-bar-fill" id="progress-bar"></div></div>
                    <div class="progress-text" id="progress-text">...% Complete</div>
                </div>
                <div class="status-details">
                    <div class="status-item"><div class="status-indicator" id="status-dot"></div><span id="status-text">...</span></div>
                    <div class="status-item"><i class="fa-solid fa-forward" style="color: var(--text-muted);"></i><span>Next Up: <span id="next-topic">...</span></span></div>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header"><i class="fa-solid fa-trophy"></i><span>Achievements</span></div>
            <div class="achievements-grid" id="achievements-grid"><p>Loading achievements...</p></div>
        </section>
      </aside>

    </div>
  </main>
  
  <div class="modal-overlay" id="timeModal">
      <div class="modal-content">
          <div class="modal-header"><h2>Edit Delivery Time</h2><button class="close-btn" data-close-modal="timeModal">&times;</button></div>
          <div class="modal-body">
              <form id="timeForm">
                  <div class="input-group"><label for="newTime">New Time (24h format)</label><input type="time" id="newTime" required></div>
                  <div class="modal-footer"><button type="submit" class="btn-save">Save New Time</button></div>
              </form>
          </div>
      </div>
  </div>
  <div class="modal-overlay" id="numberModal">
      <div class="modal-content">
          <div class="modal-header"><h2>Edit WhatsApp Number</h2><button class="close-btn" data-close-modal="numberModal">&times;</button></div>
          <div class="modal-body">
              <form id="numberForm">
                  <div class="input-group"><label for="newNumber">New WhatsApp Number</label><input type="tel" id="newNumber" placeholder="+1234567890" required></div>
                  <div class="modal-footer"><button type="submit" class="btn-save">Save New Number</button></div>
              </form>
          </div>
      </div>
  </div>

  <script>
    const courses = [ { language: "C++", levels: [ { level: "Beginner", title: "Fundamentals & Syntax", days: [ { day: 1, topic: "Structure of a Simple C++ Program (Hello World, #include, main())" }, { day: 2, topic: "Input and Output (cin, cout, endl, basic formatting)" }, { day: 3, topic: "Variables & Data Types (int, float, char, string, bool)" }, { day: 4, topic: "Operators (Arithmetic, Assignment, Increment/Decrement)" }, { day: 5, topic: "Conditional Statements (if, else, nested if)" }, { day: 6, topic: "Logical Operators & Comparisons" }, { day: 7, topic: "Switch Statements" }, { day: 8, topic: "Loops — while, do-while" }, { day: 9, topic: "Loops — for loop, nested loops" }, { day: 10, topic: "Practice: Basic Patterns & Control Flow Questions" } ] }, { level: "Intermediate", title: "Functions & Arrays", days: [ { day: 11, topic: "Functions — Basics, Declaration & Definition" }, { day: 12, topic: "Function Arguments & Return Types" }, { day: 13, topic: "Recursion Basics" }, { day: 14, topic: "Arrays — 1D Arrays Intro" }, { day: 15, topic: "Arrays — 1D Operations & Questions" }, { day: 16, topic: "2D Arrays — Basics" }, { day: 17, topic: "2D Arrays — Classic Problems (Matrix Transpose, Sum)" }, { day: 18, topic: "Strings — C++ Strings, Basic Operations" }, { day: 19, topic: "Strings — Character Arrays vs string Class" }, { day: 20, topic: "Practice: Functions + Arrays + Strings Combined Problems" } ] }, { level: "Advanced", title: "Classes, OOP & STL", days: [ { day: 21, topic: "Intro to OOP — Classes & Objects" }, { day: 22, topic: "Constructors & Destructors" }, { day: 23, topic: "Member Functions & Data Members" }, { day: 24, topic: "Encapsulation & Access Modifiers" }, { day: 25, topic: "Inheritance — Types & Examples" }, { day: 26, topic: "Polymorphism — Function Overloading" }, { day: 27, topic: "Polymorphism — Operator Overloading" }, { day: 28, topic: "Abstract Classes & Pure Virtual Functions" }, { day: 29, topic: "Intro to Standard Template Library (STL)" }, { day: 30, topic: "STL — Vectors & Iterators" } ] }, { level: "Pro", title: "Advanced Concepts + DSA", days: [ { day: 31, topic: "Pointers — Basics, * and &" }, { day: 32, topic: "Pointers — Arrays & Functions" }, { day: 33, topic: "Dynamic Memory Allocation (new and delete)" }, { day: 34, topic: "Linked Lists — Intro & Implementation" }, { day: 35, topic: "Stacks & Queues (Concepts + STL)" }, { day: 36, topic: "Trees — Basics & Binary Tree" }, { day: 37, topic: "Binary Search & Binary Search Trees" }, { day: 38, topic: "Sorting Algorithms — Bubble, Selection, Insertion" }, { day: 39, topic: "Searching Algorithms — Linear & Binary Search" }, { day: 40, topic: "Final Practice: Mixed Interview Questions (Patterns, STL, DSA)" } ] } ] }, { language: "Java", levels: [ { level: "Beginner", title: "Java Basics & Syntax", days: [ { day: 1, topic: "Intro: How Java Works, JVM, JDK, First Hello World" }, { day: 2, topic: "Variables & Data Types" }, { day: 3, topic: "Input & Output — Scanner" }, { day: 4, topic: "Operators — Arithmetic, Assignment" }, { day: 5, topic: "Conditional Statements — if, else if, else" }, { day: 6, topic: "Logical Operators & Comparisons" }, { day: 7, topic: "Switch Case" }, { day: 8, topic: "Loops — while & do-while" }, { day: 9, topic: "Loops — for loop, nested loops" }, { day: 10, topic: "Practice: Basic Pattern Printing" } ] }, { level: "Intermediate", title: "Methods & Arrays", days: [ { day: 11, topic: "Methods — Definition & Calling" }, { day: 12, topic: "Method Overloading" }, { day: 13, topic: "Recursion Basics" }, { day: 14, topic: "Arrays — 1D Arrays" }, { day: 15, topic: "Arrays — Basic Problems" }, { day: 16, topic: "2D Arrays" }, { day: 17, topic: "2D Array Classic Problems (Transpose, Sum)" }, { day: 18, topic: "Strings — Basics & String Class" }, { day: 19, topic: "String Methods & Immutability" }, { day: 20, topic: "Practice: Arrays + Strings Problems" } ] }, { level: "Advanced", title: "OOP & Advanced Classes", days: [ { day: 21, topic: "OOP Concepts — Classes & Objects" }, { day: 22, topic: "Constructors" }, { day: 23, topic: "Getters & Setters" }, { day: 24, topic: "this Keyword" }, { day: 25, topic: "Inheritance" }, { day: 26, topic: "super Keyword" }, { day: 27, topic: "Method Overriding" }, { day: 28, topic: "Polymorphism" }, { day: 29, topic: "Abstraction & Interfaces" }, { day: 30, topic: "Encapsulation — Real Example" } ] }, { level: "Pro", title: "Core DSA & Collections", days: [ { day: 31, topic: "Intro to Java Collections" }, { day: 32, topic: "ArrayList — Basics & Operations" }, { day: 33, topic: "LinkedList — Basics & Operations" }, { day: 34, topic: "HashMap — Basics & Use Cases" }, { day: 35, topic: "HashSet — Basics & Differences" }, { day: 36, topic: "Stack & Queue in Java" }, { day: 37, topic: "Sorting Algorithms — Bubble & Selection" }, { day: 38, topic: "Searching — Linear & Binary Search" }, { day: 39, topic: "Trees — Basic Binary Tree Concepts" }, { day: 40, topic: "Practice Day — Mixed DSA Questions" } ] } ] } ];
    const token = localStorage.getItem('token');
    if (!token) { window.location.href = 'login.html'; }

    let currentUserState = {};

    function renderCurriculum(userCourse, completedDaysSet) {
        const container = document.getElementById('curriculum-container');
        if (!container || !userCourse) { container.innerHTML = '<p>Could not load curriculum.</p>'; return; }
        container.innerHTML = '';
        const topicSlidePanel = document.createElement('div');
        topicSlidePanel.className = 'topic-slide-panel';
        let activeDayCard = null;
        userCourse.levels.forEach(level => {
            const levelDiv = document.createElement('div');
            levelDiv.className = 'course-level';
            levelDiv.innerHTML = `<h4><i class="fas fa-layer-group"></i> ${level.level}: <span class="level-title">${level.title}</span></h4>`;
            const daysDiv = document.createElement('div');
            daysDiv.className = 'days';
            level.days.forEach(day => {
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                dayCard.textContent = `Day ${day.day}`;
                dayCard.dataset.topic = day.topic;
                if (completedDaysSet.has(day.day)) { dayCard.classList.add('completed'); }
                dayCard.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (dayCard === activeDayCard) {
                        topicSlidePanel.classList.remove('show');
                        activeDayCard.classList.remove('active');
                        activeDayCard = null;
                        return;
                    }
                    if(activeDayCard) activeDayCard.classList.remove('active');
                    topicSlidePanel.innerHTML = `<strong>Day ${day.day} Topic:</strong> ${day.topic}`;
                    daysDiv.after(topicSlidePanel);
                    topicSlidePanel.classList.add('show');
                    dayCard.classList.add('active');
                    activeDayCard = dayCard;
                });
                daysDiv.appendChild(dayCard);
            });
            levelDiv.appendChild(daysDiv);
            container.appendChild(levelDiv);
        });
        document.addEventListener('click', () => {
            if (activeDayCard) {
                topicSlidePanel.classList.remove('show');
                activeDayCard.classList.remove('active');
                activeDayCard = null;
            }
        });
    }

    const quickTips = {
  "C++": [
    "Use `const` whenever possible to prevent accidental modification of variables.",
    "Prefer `std::vector` over raw C-style arrays for dynamic sizing and safety.",
    "The 'Rule of Three/Five/Zero' is a key concept for managing resources in classes.",
    "Always initialize your variables. Uninitialized variables can lead to unpredictable behavior.",
    "Use `nullptr` instead of `NULL` in modern C++ for type safety."
  ],
  "Java": [
    "Remember that `String` objects in Java are immutable. Use `StringBuilder` for heavy string manipulation.",
    "The `equals()` method checks for content equality, while `==` checks for object reference equality.",
    "Use the Enhanced For-Loop (for-each) for cleaner iteration over collections and arrays.",
    "Always override `hashCode()` when you override `equals()` to maintain the contract.",
    "Interfaces are a powerful way to achieve abstraction and multiple inheritance of type."
  ]
};

// ✅✅✅ COPY AND REPLACE YOUR OLD topicResources OBJECT WITH THIS ONE ✅✅✅

const topicResources = {
  // C++ & Java - Beginner
  "Hello World": [
    { title: "GeeksforGeeks: C++ Hello World", url: "https://www.geeksforgeeks.org/c-program-to-print-hello-world/" },
    { title: "W3Schools: Java Hello World", url: "https://www.w3schools.com/java/java_getstarted.asp" }
  ],
  "Input and Output": [
    { title: "cplusplus.com: C++ Basic I/O (cin/cout)", url: "http://www.cplusplus.com/doc/tutorial/basic_io/" },
    { title: "Baeldung: Java Scanner Class", url: "https://www.baeldung.com/java-scanner" }
  ],
  "Variables & Data Types": [
    { title: "TutorialsPoint: C++ Data Types", url: "https://www.tutorialspoint.com/cplusplus/cpp_data_types.htm" },
    { title: "Oracle Docs: Java Primitive Data Types", url: "https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html" }
  ],
  "Operators": [
    { title: "GeeksforGeeks: C++ Operators", url: "https://www.geeksforgeeks.org/operators-in-cpp/" },
    { title: "W3Schools: Java Operators", url: "https://www.w3schools.com/java/java_operators.asp" }
  ],
  "Conditional Statements": [
    { title: "Microsoft Docs: C++ if-else Statement", url: "https://learn.microsoft.com/en-us/cpp/cpp/if-else-statement-cpp" },
    { title: "DigitalOcean: Java if-else", url: "https://www.digitalocean.com/community/tutorials/java-if-else-statement" }
  ],
  "Switch Statements": [
    { title: "GeeksforGeeks: C++ switch Statement", url: "https://www.geeksforgeeks.org/switch-statement-in-c-cpp/" },
    { title: "Baeldung: Java switch Statement", url: "https://www.baeldung.com/java-switch" }
  ],
  "Loops": [
    { title: "Programiz: C++ for Loop", url: "https://www.programiz.com/cpp-programming/for-loop" },
    { title: "Programiz: Java for Loop", url: "https://www.programiz.com/java-programming/for-loop" }
  ],

  // C++ & Java - Intermediate
  "Functions": [
    { title: "W3Schools: C++ Functions", url: "https://www.w3schools.com/cpp/cpp_functions.asp" },
    { title: "Baeldung: Java Methods", url: "https://www.baeldung.com/java-methods" }
  ],
  "Recursion": [
    { title: "GeeksforGeeks: Recursion in C++", url: "https://www.geeksforgeeks.org/recursion-in-c/" },
    { title: "Video: Java Recursion Explained", url: "https://www.youtube.com/watch?v=IJDJ0kBx2gw" }
  ],
  "Arrays": [
    { title: "cplusplus.com: C++ Arrays", url: "http://www.cplusplus.com/doc/tutorial/arrays/" },
    { title: "Oracle Docs: Java Arrays", url: "https://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html" }
  ],
  "Strings": [
    { title: "GeeksforGeeks: C++ string Class", url: "https://www.geeksforgeeks.org/stdstring-class-in-c/" },
    { title: "Baeldung: Guide to Java String", url: "https://www.baeldung.com/java-string" }
  ],

  // C++ & Java - Advanced (OOP)
  "OOP": [
    { title: "FreeCodeCamp: OOP in C++", url: "https://www.freecodecamp.org/news/object-oriented-programming-in-c/" },
    { title: "Oracle Docs: OOP Concepts in Java", url: "https://docs.oracle.com/javase/tutorial/java/concepts/index.html" }
  ],
  "Classes & Objects": [
    { title: "GeeksforGeeks: C++ Classes and Objects", url: "https://www.geeksforgeeks.org/c-classes-and-objects/" },
    { title: "W3Schools: Java Classes/Objects", url: "https://www.w3schools.com/java/java_classes.asp" }
  ],
  "Constructors": [
    { title: "Programiz: C++ Constructors", url: "https://www.programiz.com/cpp-programming/constructors" },
    { title: "Baeldung: Java Constructors", url: "https://www.baeldung.com/java-constructors" }
  ],
  "Inheritance": [
    { title: "cplusplus.com: C++ Inheritance", url: "http://www.cplusplus.com/doc/tutorial/inheritance/" },
    { title: "GeeksforGeeks: Inheritance in Java", url: "https://www.geeksforgeeks.org/inheritance-in-java/" }
  ],
  "Polymorphism": [
    { title: "GeeksforGeeks: Polymorphism in C++", url: "https://www.geeksforgeeks.org/polymorphism-in-c/" },
    { title: "Baeldung: Polymorphism in Java", url: "https://www.baeldung.com/java-polymorphism" }
  ],
  "Abstraction": [
    { title: "TutorialsPoint: C++ Abstraction", url: "https://www.tutorialspoint.com/cplusplus/cpp_data_abstraction.htm" },
    { title: "W3Schools: Java Abstraction", url: "https://www.w3schools.com/java/java_abstract.asp" }
  ],
  "Interfaces": [
    { title: "GeeksforGeeks: C++ Abstract Class/Interfaces", url: "https://www.geeksforgeeks.org/interfaces-in-c/" },
    { title: "Oracle Docs: Java Interfaces", url: "https://docs.oracle.com/javase/tutorial/java/IandI/createinterface.html" }
  ],
  
  // Pro Level - Specific Concepts
  "Pointers": [
    { title: "GeeksforGeeks: C++ Pointers", url: "https://www.geeksforgeeks.org/cpp-pointers/" },
    { title: "Video: Pointers in C++ in 15 Mins", url: "https://www.youtube.com/watch?v=EvYmTCasB4A" }
  ],
  "STL": [
      { title: "TopCoder: Power of C++ STL", url: "https://www.topcoder.com/thrive/articles/Power-of-C-Standard-Template-Library-STL" },
      { title: "Video: C++ STL Full Course", url: "https://www.youtube.com/watch?v=s_t0Ua2jA-c" }
  ],
  "Vectors": [
    { title: "cplusplus.com: C++ std::vector", url: "https://cplusplus.com/reference/vector/vector/"},
    { title: "Baeldung: Java ArrayList", url: "https://www.baeldung.com/java-arraylist"}
  ],
  "Collections": [
      { title: "Baeldung: Guide to Java Collections", url: "https://www.baeldung.com/java-collections" },
      { title: "Video: Java Collections Framework", url: "https://www.youtube.com/watch?v=rzA7UJ-hQn4" }
  ],
  "HashMap": [
    { title: "GeeksforGeeks: C++ std::unordered_map", url: "https://www.geeksforgeeks.org/unordered_map-in-cpp-stl/" },
    { title: "Baeldung: Java HashMap", url: "https://www.baeldung.com/java-hashmap" }
  ],
  "Linked Lists": [
    { title: "Programiz: C++ Linked List", url: "https://www.programiz.com/dsa/linked-list" },
    { title: "GeeksforGeeks: Java LinkedList", url: "https://www.geeksforgeeks.org/linked-list-in-java/" }
  ],
  "Stacks & Queues": [
    { title: "GeeksforGeeks: C++ Stack vs Queue", url: "https://www.geeksforgeeks.org/stack-vs-queue/" },
    { title: "Baeldung: Java Stack and Queue", url: "https://www.baeldung.com/java-stack-queue" }
  ],
  "Trees": [
    { title: "FreeCodeCamp: Tree Data Structure", url: "https://www.freecodecamp.org/news/tree-data-structure-in-c-plus-plus/" },
    { title: "Baeldung: Binary Tree in Java", url: "https://www.baeldung.com/java-binary-tree" }
  ],
  "Sorting Algorithms": [
    { title: "GeeksforGeeks: C++ Sorting Algorithms", url: "https://www.geeksforgeeks.org/sorting-algorithms-in-c/" },
    { title: "HackerEarth: Sorting Algorithms in Java", url: "https://www.hackerearth.com/practice/algorithms/sorting/bubble-sort/tutorial/" }
  ],
  "Searching Algorithms": [
    { title: "Programiz: C++ Binary Search", url: "https://www.programiz.com/dsa/binary-search" },
    { title: "Baeldung: Binary Search in Java", url: "https://www.baeldung.com/java-binary-search" }
  ]
};


    function updateDashboardUI(data) {
        const userCourse = courses.find(c => c.language === data.language);
        const streak = data.streakCount || 0;
        const completedDays = data.completedTopics.length;

        document.getElementById('welcomeName').textContent = data.name;
        document.getElementById('nav-streak').textContent = streak;
        document.getElementById('profile-avatar').textContent = data.name.charAt(0).toUpperCase();
        document.getElementById('dropdown-username').textContent = data.name;
        
        document.getElementById('lang').textContent = data.language;
        document.getElementById('level').textContent = data.level;
        document.getElementById('wa').textContent = data.whatsapp;
        document.getElementById('time').textContent = data.deliveryTime;
        
        const pauseBtn = document.getElementById('pauseBtn');
        pauseBtn.textContent = data.isPaused ? 'Resume Course' : 'Pause Course';
        pauseBtn.className = data.isPaused ? 'btn-action btn-resume' : 'btn-action btn-pause';
        
        const totalDays = 40;
        const progressPercent = Math.round((completedDays / totalDays) * 100);
        document.getElementById('streak-card').textContent = streak;
        document.getElementById('progress-bar').style.width = `${progressPercent}%`;
        document.getElementById('progress-text').textContent = `${completedDays} of ${totalDays} days complete`;
        
        const statusDot = document.getElementById('status-dot');
        const statusText = document.getElementById('status-text');
        if (data.isPaused) {
            statusDot.className = 'status-indicator paused';
            statusText.textContent = 'Paused';
        } else {
            statusDot.className = 'status-indicator active';
            statusText.textContent = 'Active';
        }

        let nextTopic = "Course Complete!";
        if (userCourse && data.currentDay <= totalDays) {
            const allDays = userCourse.levels.flatMap(level => level.days);
            const nextDayTopic = allDays.find(day => day.day === data.currentDay);
            if (nextDayTopic) { nextTopic = nextDayTopic.topic; }
        }
        document.getElementById('next-topic').textContent = nextTopic;

        const logList = document.getElementById('logList');
        logList.innerHTML = '';
        if (data.completedTopics && data.completedTopics.length > 0) {
          data.completedTopics.forEach(t => {
            const cardLink = document.createElement('a');
            cardLink.className = 'log-card';
            cardLink.href = `day.html?day=${t.order}`;
            cardLink.innerHTML = `<div class="day-number">${t.order}</div><div class="day-title">Day ${t.order}</div><span class="day-level">${data.level}</span>`;
            logList.appendChild(cardLink);
          });
        } else {
          logList.innerHTML = '<p>Your journey begins! Complete your first task to see it here.</p>';
        }

        const completedDaysSet = new Set(data.completedTopics.map(t => t.order));
        renderCurriculum(userCourse, completedDaysSet);
        renderAchievements(data.achievements);
         renderTipsAndResources(data.language, nextTopic);
    }
   
    // In dashboard.html <script> tag

        // ✅✅✅ START: ADD THIS NEW JAVASCRIPT FUNCTION ✅✅✅
function renderTipsAndResources(language, nextTopic) {
    const tipContainer = document.getElementById('quick-tip-text');
    const resourceContainer = document.getElementById('resource-hub-content');
    
    // --- 1. Render a random Quick Tip ---
    const tipsForLang = quickTips[language] || [];
    if (tipsForLang.length > 0) {
        const randomIndex = Math.floor(Math.random() * tipsForLang.length);
        tipContainer.textContent = tipsForLang[randomIndex];
    } else {
        tipContainer.textContent = 'No tips available for this language yet.';
    }
    
    // --- 2. Render resources based on the next topic ---
    let resourcesFound = false;
    let resourceHTML = `<h5><i class="fa-solid fa-book-bookmark"></i> Resources for: ${nextTopic}</h5><ul>`;

    // Loop through our resource keywords
    for (const keyword in topicResources) {
        // Check if the next topic string contains our keyword (case-insensitive)
        if (nextTopic.toLowerCase().includes(keyword.toLowerCase())) {
            const resources = topicResources[keyword];
            resources.forEach(resource => {
                resourceHTML += `<li><a href="${resource.url}" target="_blank" class="resource-link"><i class="fa-solid fa-arrow-up-right-from-square"></i>${resource.title}</a></li>`;
            });
            resourcesFound = true;
            break; // Stop after finding the first matching keyword to avoid duplicates
        }
    }
    
    if (resourcesFound) {
        resourceContainer.innerHTML = resourceHTML + '</ul>';
    } else {
        resourceContainer.innerHTML = `<h5><i class="fa-solid fa-magnifying-glass"></i> No specific resources found for this topic. Keep exploring!</h5>`;
    }
}
// ✅✅✅ END: ADD THIS NEW JAVASCRIPT FUNCTION ✅✅✅

async function loadDashboard() {
  try {
    const res = await fetch('/api/user/me', { headers: { 'Authorization': `Bearer ${token}` } });
    if (!res.ok) { throw new Error('Session expired or unauthorized.'); }
    
    // ✅✅✅ THE FIX: Read the JSON data FIRST ✅✅✅
    const data = await res.json();
    
    // Now that 'data' exists, we can check the subscription status.
    if (data.subscriptions && data.subscriptions.length > 0) {
        window.location.href = 'pro-dashboard.html';
        return; // Redirect and stop executing this script.
    }
    
    // If the user is NOT subscribed, store their data and update the free dashboard.
    currentUserState = data;
    
    if (!currentUserState.language || !currentUserState.level) {
      alert('Please complete your schedule setup.');
      window.location.href = 'set-schedule.html';
      return;
    }
    
    updateDashboardUI(currentUserState);

  } catch (error) {
    alert(error.message);
    localStorage.removeItem('token');
    window.location.href = 'login.html';
  }
}

    document.addEventListener('DOMContentLoaded', loadDashboard);
    
    // Dropdown and other buttons
    const profileAvatar = document.getElementById('profile-avatar');
    const profileDropdown = document.getElementById('profile-dropdown');
    profileAvatar.addEventListener('click', (e) => { e.stopPropagation(); profileDropdown.classList.toggle('show'); });
    window.addEventListener('click', (e) => { if (!e.target.closest('.profile-menu-container')) { profileDropdown.classList.remove('show'); } });
    document.getElementById('editBtn').onclick = () => { if (confirm('Editing your full schedule will reset your course progress to Day 1. Are you sure?')) { window.location.href = 'set-schedule.html'; } };
    document.getElementById('logoutBtn').onclick = () => { localStorage.removeItem('token'); window.location.href = 'index.html'; };
    
    // ✅✅✅ ALL BUTTON LOGIC CONSOLIDATED HERE ✅✅✅
    document.getElementById('refresh-tip-btn').addEventListener('click', () => {
        if (currentUserState.language) {
            // We only need to refresh the tip part.
            const tipContainer = document.getElementById('quick-tip-text');
            const tipsForLang = quickTips[currentUserState.language] || [];
            if (tipsForLang.length > 0) {
                const randomIndex = Math.floor(Math.random() * tipsForLang.length);
                tipContainer.textContent = tipsForLang[randomIndex];
            }
        }
    });
    document.getElementById('pauseBtn').onclick = async () => {
        const pauseBtn = document.getElementById('pauseBtn');
        pauseBtn.disabled = true;
        
        // If user is resuming, we tell the backend to reset the streak
        const isResuming = currentUserState.isPaused;
        const bodyPayload = isResuming ? { resetStreak: true } : {};

        try {
            const res = await fetch('/api/user/pause', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                body: JSON.stringify(bodyPayload)
            });
            if (!res.ok) { throw new Error((await res.json()).message || 'Failed to update status.'); }
            
            const data = await res.json();
            alert(data.message);
            currentUserState = data.user; // Update state from server response
            updateDashboardUI(currentUserState); // Re-render everything
        } catch (error) {
            alert('Error: ' + error.message);
        } finally {
            pauseBtn.disabled = false;
        }
    };

    const timeModal = document.getElementById('timeModal');
    const numberModal = document.getElementById('numberModal');
    const editTimeBtn = document.getElementById('editTimeBtn');
    const editNumberBtn = document.getElementById('editNumberBtn');
    const closeButtons = document.querySelectorAll('.close-btn');

    const openModal = (modal) => modal.classList.add('show');
    const closeModal = (modal) => modal.classList.remove('show');

    editTimeBtn.addEventListener('click', (e) => { e.preventDefault(); openModal(timeModal); });
    editNumberBtn.addEventListener('click', (e) => { e.preventDefault(); openModal(numberModal); });
    closeButtons.forEach(btn => {
        const modalId = btn.dataset.closeModal;
        btn.addEventListener('click', () => closeModal(document.getElementById(modalId)));
    });

    document.getElementById('timeForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const newTime = document.getElementById('newTime').value;
        try {
            const res = await fetch('/api/user/update-time', {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                body: JSON.stringify({ deliveryTime: newTime })
            });
            if (!res.ok) { throw new Error((await res.json()).message || 'Failed to update time.'); }
            
            const data = await res.json();
            alert(data.message);
            currentUserState = data.user;
            updateDashboardUI(currentUserState);
            closeModal(timeModal);
        } catch (error) {
            alert('Error: ' + error.message);
        }
    });

    document.getElementById('numberForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const newNumber = document.getElementById('newNumber').value;
        try {
            const res = await fetch('/api/user/update-number', {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                body: JSON.stringify({ whatsapp: newNumber })
            });
            if (!res.ok) { throw new Error((await res.json()).message || 'Failed to update number.'); }

            const data = await res.json();
            alert(data.message);
            currentUserState = data.user;
            updateDashboardUI(currentUserState);
            closeModal(numberModal);
        } catch (error) {
            alert('Error: ' + error.message);
        }
    });

    document.getElementById('deleteAccountBtn').onclick = async () => {
        if (!confirm("Are you sure? This will delete all your data permanently.")) return;
        if (!confirm("Last chance. This action cannot be undone. Delete?")) return;
        try {
            const res = await fetch('/api/user/delete', {
                method: 'DELETE',
                headers: { 'Authorization': `Bearer ${token}` }
            });
            if (res.ok) {
                alert('Account deleted.');
                localStorage.removeItem('token');
                window.location.href = 'index.html';
            } else {
                const data = await res.json();
                throw new Error(data.message || 'Failed to delete account.');
            }
        } catch (error) {
            alert('Error: ' + error.message);
        }
    };
     let progressChart = null; // To hold the chart instance

    // ✅✅✅ 1. DEFINE ALL POSSIBLE BADGES ✅✅✅
    const allBadges = {
      'INITIATED': { icon: 'fa-solid fa-play', title: 'Initiated', desc: 'Completed Day 1' },
      '7_DAY_STREAK': { icon: 'fa-solid fa-fire-flame-curved', title: 'On Fire', desc: 'Maintained a 7-day streak' },
      '15_DAY_STREAK': { icon: 'fa-solid fa-meteor', title: 'Meteor Shower', desc: 'Maintained a 15-day streak' },
      'HALF_WAY': { icon: 'fa-solid fa-mountain-sun', title: 'Halfway There', desc: 'Completed Day 20' },
      'COURSE_COMPLETE': { icon: 'fa-solid fa-crown', title: 'Master Coder', desc: 'Completed all 40 days!' },
      'WEEKEND_WARRIOR': { icon: 'fa-solid fa-calendar-week', title: 'Weekend Warrior', desc: 'Completed a task on a weekend' }
    };
        // ... after the openTopicModal function ...

    // ✅✅✅ 2. CREATE THE FUNCTION TO RENDER BADGES ✅✅✅
    function renderAchievements(unlockedBadges = []) {
        const grid = document.getElementById('achievements-grid');
        grid.innerHTML = '';

        for (const badgeKey in allBadges) {
            const badge = allBadges[badgeKey];
            const isUnlocked = unlockedBadges.includes(badgeKey);

            const badgeElement = document.createElement('div');
            badgeElement.className = 'badge';
            
            badgeElement.innerHTML = `
                <div class="badge-icon ${isUnlocked ? 'unlocked' : ''}" data-tooltip="${badge.desc}">
                    <i class="${badge.icon}"></i>
                </div>
                <div class="badge-title">${badge.title}</div>
            `;
            grid.appendChild(badgeElement);
        }
    }
  </script>
</body>
</html>